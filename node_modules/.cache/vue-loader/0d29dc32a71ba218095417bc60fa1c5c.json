{"remainingRequest":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue","mtime":1603989544648},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRleHQ6ICIiLA0KICAgICAgZmlsZUxpc3Q6IFtdLA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBpbWdzYygpIHsNCiAgICAgIGNvbnNvbGUubG9nKCIxIik7DQogICAgICBpZiAodGhpcy5maWxlTGlzdC5sZW5ndGggPT0gMCB8fCB0aGlzLnRleHQubGVuZ3RoID09IDApIHsNCiAgICAgICAgY29uc29sZS5sb2coIjIiKTsNCiAgICAgICAgdGhpcy4kdG9hc3Qoew0KICAgICAgICAgIG1lc3NhZ2U6ICLmsqHmnInlhoXlrrnlj6/lj5HluIMiLA0KICAgICAgICAgIHBvc2l0aW9uOiAidG9wIiwNCiAgICAgICAgICBkdXJhdGlvbjogIjEwMDAiLA0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGxldCB1c2VuYW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVuYW1lIik7DQogICAgICAgIGxldCBhcnIgPSBbXTsNCiAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7DQogICAgICAgIGZvciAobGV0IHZhbCBvZiB0aGlzLmZpbGVMaXN0KSB7DQogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlcyIsIHZhbC5maWxlKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5hZnRlclJlYWQoKSkgew0KICAgICAgICAgIHRoaXMuJGluZGljYXRvci5vcGVuKHsNCiAgICAgICAgICAgIHRleHQ6ICLliqDovb3kuK0uLi4iLA0KICAgICAgICAgICAgc3Bpbm5lclR5cGU6ICJ0cmlwbGUtYm91bmNlIiwNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLmF4aW9zDQogICAgICAgICAgICAucG9zdCgiL3VzZXJzL3VwbG9hZCIsIGZvcm1EYXRhLCB7DQogICAgICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICAgICBlbmN0eXBlOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YSIsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgICBsZXQgc3JjID0gcmVzLmRhdGEuYXJyOw0KICAgICAgICAgICAgICB0aGlzLmF4aW9zDQogICAgICAgICAgICAgICAgLnBvc3QoDQogICAgICAgICAgICAgICAgICAiL3VzZXJzL3Rlc3QiLA0KICAgICAgICAgICAgICAgICAgYGFycj0ke3NyY30mdGV4dD0ke3RoaXMudGV4dH0mdXNlbmFtZT0ke3VzZW5hbWV9YA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc2F4ID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kaW5kaWNhdG9yLmNsb3NlKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0KHsNCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5Y+R6KGo5oiQ5YqfIiwNCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcCIsDQogICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246ICIxMDAwIiwNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvZG9uZ3RhaSIpOw0KICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTsNCiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0KHsNCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5Y+R6KGo5aSx6LSlIiwNCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcCIsDQogICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246ICIxMDAwIiwNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvZG9uZ3RhaSIpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIGFmdGVyUmVhZChmaWxlKSB7DQogICAgICAvLyBjb25zb2xlLmxvZyhmaWxlKTsNCiAgICAgIGZvciAodmFyIHZhbCBvZiB0aGlzLmZpbGVMaXN0KSB7DQogICAgICAgIGlmICgNCiAgICAgICAgICB2YWwuZmlsZS50eXBlICE9PSAiaW1hZ2UvanBlZyIgJiYNCiAgICAgICAgICB2YWwuZmlsZS50eXBlICE9PSAiaW1hZ2UvcG5nIiAmJg0KICAgICAgICAgIHZhbC5maWxlLnR5cGUgIT09ICJpbWFnZS9naWYiDQogICAgICAgICkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Vib3goIuS4iuS8oOaPkOekuiIsICLlj6rog73kuIrkvKBwbmfmiJZqcGfmiJZnaWbmoLzlvI/nmoTlm77niYciKTsNCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0sDQogICAgb25PdmVyc2l6ZShmaWxlKSB7DQogICAgICB0aGlzLiRtZXNzYWdlYm94KCLkuIrkvKDmj5DnpLoiLCAi5paH5Lu25LiN6IO96LaF6L+HNTAwa2IiKTsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["imgs.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"imgs.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"imgs fens\">\r\n    <mt-header title=\"动态\">\r\n      <router-link to=\"/dongtai\" slot=\"left\">\r\n        <mt-button type=\"default\" icon=\"back\" size=\"normal\"></mt-button>\r\n      </router-link>\r\n    </mt-header>\r\n    <div>\r\n      <textarea\r\n        v-model=\"text\"\r\n        placeholder=\"说说您此刻的想法\"\r\n        class=\"textar\"\r\n      ></textarea>\r\n    </div>\r\n    <div class=\"dongtai\">\r\n      <van-uploader\r\n        v-model=\"fileList\"\r\n        multiple\r\n        :after-read=\"afterRead\"\r\n        :max-count=\"9\"\r\n        :max-size=\"500 * 1024\"\r\n        @oversize=\"onOversize\"\r\n      />\r\n      <br />\r\n      <mt-button @click=\"imgsc\" type=\"primary\" size=\"large\">发布</mt-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style  >\r\n/* 导航粉色 */\r\n.imgs.fens .mint-header {\r\n  background: #ff6699;\r\n}\r\n/* 棕色 */\r\n.imgs.zong .mint-header {\r\n  background: #9b7159;\r\n}\r\n.imgs .textar {\r\n  width: 100%;\r\n  margin: 0;\r\n  box-sizing: border-box;\r\n  padding: 20px;\r\n  border: none;\r\n  resize: none;\r\n}\r\n.imgs .dongtai {\r\n  padding: 20px;\r\n}\r\n.imgs.fens .mint-button--primary {\r\n  background: #ffccdd;\r\n}\r\n/* 按钮粉色系 */\r\n.imgs.zong .mint-button--primary {\r\n  background: #9b7159;\r\n}\r\n</style>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      text: \"\",\r\n      fileList: [],\r\n    };\r\n  },\r\n  methods: {\r\n    imgsc() {\r\n      console.log(\"1\");\r\n      if (this.fileList.length == 0 || this.text.length == 0) {\r\n        console.log(\"2\");\r\n        this.$toast({\r\n          message: \"没有内容可发布\",\r\n          position: \"top\",\r\n          duration: \"1000\",\r\n        });\r\n      } else {\r\n        let usename = localStorage.getItem(\"uname\");\r\n        let arr = [];\r\n        let formData = new FormData();\r\n        for (let val of this.fileList) {\r\n          formData.append(\"files\", val.file);\r\n        }\r\n        if (this.afterRead()) {\r\n          this.$indicator.open({\r\n            text: \"加载中...\",\r\n            spinnerType: \"triple-bounce\",\r\n          });\r\n          this.axios\r\n            .post(\"/users/upload\", formData, {\r\n              headers: {\r\n                enctype: \"multipart/form-data\",\r\n              },\r\n            })\r\n            .then((res) => {\r\n              let src = res.data.arr;\r\n              this.axios\r\n                .post(\r\n                  \"/users/test\",\r\n                  `arr=${src}&text=${this.text}&usename=${usename}`\r\n                )\r\n                .then((res) => {\r\n                  if (res.data.sax == 1) {\r\n                    this.$indicator.close();\r\n                    this.$toast({\r\n                      message: \"发表成功\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    setTimeout(() => {\r\n                      this.$router.push(\"/dongtai\");\r\n                    }, 2000);\r\n                  } else {\r\n                    this.$toast({\r\n                      message: \"发表失败\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    this.$router.push(\"/dongtai\");\r\n                  }\r\n                });\r\n            });\r\n        }\r\n      }\r\n    },\r\n    afterRead(file) {\r\n      // console.log(file);\r\n      for (var val of this.fileList) {\r\n        if (\r\n          val.file.type !== \"image/jpeg\" &&\r\n          val.file.type !== \"image/png\" &&\r\n          val.file.type !== \"image/gif\"\r\n        ) {\r\n          this.$messagebox(\"上传提示\", \"只能上传png或jpg或gif格式的图片\");\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n    onOversize(file) {\r\n      this.$messagebox(\"上传提示\", \"文件不能超过500kb\");\r\n      return false;\r\n    },\r\n  },\r\n};\r\n</script>"]}]}