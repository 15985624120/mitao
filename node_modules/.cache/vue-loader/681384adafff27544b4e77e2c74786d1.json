{"remainingRequest":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue","mtime":1603989544648},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLyog5a+86Iiq57KJ6ImyICovDQouaW1ncy5mZW5zIC5taW50LWhlYWRlciB7DQogIGJhY2tncm91bmQ6ICNmZjY2OTk7DQp9DQovKiDmo5XoibIgKi8NCi5pbWdzLnpvbmcgLm1pbnQtaGVhZGVyIHsNCiAgYmFja2dyb3VuZDogIzliNzE1OTsNCn0NCi5pbWdzIC50ZXh0YXIgew0KICB3aWR0aDogMTAwJTsNCiAgbWFyZ2luOiAwOw0KICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICBwYWRkaW5nOiAyMHB4Ow0KICBib3JkZXI6IG5vbmU7DQogIHJlc2l6ZTogbm9uZTsNCn0NCi5pbWdzIC5kb25ndGFpIHsNCiAgcGFkZGluZzogMjBweDsNCn0NCi5pbWdzLmZlbnMgLm1pbnQtYnV0dG9uLS1wcmltYXJ5IHsNCiAgYmFja2dyb3VuZDogI2ZmY2NkZDsNCn0NCi8qIOaMiemSrueyieiJsuezuyAqLw0KLmltZ3Muem9uZyAubWludC1idXR0b24tLXByaW1hcnkgew0KICBiYWNrZ3JvdW5kOiAjOWI3MTU5Ow0KfQ0K"},{"version":3,"sources":["imgs.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"imgs.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"imgs fens\">\r\n    <mt-header title=\"动态\">\r\n      <router-link to=\"/dongtai\" slot=\"left\">\r\n        <mt-button type=\"default\" icon=\"back\" size=\"normal\"></mt-button>\r\n      </router-link>\r\n    </mt-header>\r\n    <div>\r\n      <textarea\r\n        v-model=\"text\"\r\n        placeholder=\"说说您此刻的想法\"\r\n        class=\"textar\"\r\n      ></textarea>\r\n    </div>\r\n    <div class=\"dongtai\">\r\n      <van-uploader\r\n        v-model=\"fileList\"\r\n        multiple\r\n        :after-read=\"afterRead\"\r\n        :max-count=\"9\"\r\n        :max-size=\"500 * 1024\"\r\n        @oversize=\"onOversize\"\r\n      />\r\n      <br />\r\n      <mt-button @click=\"imgsc\" type=\"primary\" size=\"large\">发布</mt-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style  >\r\n/* 导航粉色 */\r\n.imgs.fens .mint-header {\r\n  background: #ff6699;\r\n}\r\n/* 棕色 */\r\n.imgs.zong .mint-header {\r\n  background: #9b7159;\r\n}\r\n.imgs .textar {\r\n  width: 100%;\r\n  margin: 0;\r\n  box-sizing: border-box;\r\n  padding: 20px;\r\n  border: none;\r\n  resize: none;\r\n}\r\n.imgs .dongtai {\r\n  padding: 20px;\r\n}\r\n.imgs.fens .mint-button--primary {\r\n  background: #ffccdd;\r\n}\r\n/* 按钮粉色系 */\r\n.imgs.zong .mint-button--primary {\r\n  background: #9b7159;\r\n}\r\n</style>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      text: \"\",\r\n      fileList: [],\r\n    };\r\n  },\r\n  methods: {\r\n    imgsc() {\r\n      console.log(\"1\");\r\n      if (this.fileList.length == 0 || this.text.length == 0) {\r\n        console.log(\"2\");\r\n        this.$toast({\r\n          message: \"没有内容可发布\",\r\n          position: \"top\",\r\n          duration: \"1000\",\r\n        });\r\n      } else {\r\n        let usename = localStorage.getItem(\"uname\");\r\n        let arr = [];\r\n        let formData = new FormData();\r\n        for (let val of this.fileList) {\r\n          formData.append(\"files\", val.file);\r\n        }\r\n        if (this.afterRead()) {\r\n          this.$indicator.open({\r\n            text: \"加载中...\",\r\n            spinnerType: \"triple-bounce\",\r\n          });\r\n          this.axios\r\n            .post(\"/users/upload\", formData, {\r\n              headers: {\r\n                enctype: \"multipart/form-data\",\r\n              },\r\n            })\r\n            .then((res) => {\r\n              let src = res.data.arr;\r\n              this.axios\r\n                .post(\r\n                  \"/users/test\",\r\n                  `arr=${src}&text=${this.text}&usename=${usename}`\r\n                )\r\n                .then((res) => {\r\n                  if (res.data.sax == 1) {\r\n                    this.$indicator.close();\r\n                    this.$toast({\r\n                      message: \"发表成功\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    setTimeout(() => {\r\n                      this.$router.push(\"/dongtai\");\r\n                    }, 2000);\r\n                  } else {\r\n                    this.$toast({\r\n                      message: \"发表失败\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    this.$router.push(\"/dongtai\");\r\n                  }\r\n                });\r\n            });\r\n        }\r\n      }\r\n    },\r\n    afterRead(file) {\r\n      // console.log(file);\r\n      for (var val of this.fileList) {\r\n        if (\r\n          val.file.type !== \"image/jpeg\" &&\r\n          val.file.type !== \"image/png\" &&\r\n          val.file.type !== \"image/gif\"\r\n        ) {\r\n          this.$messagebox(\"上传提示\", \"只能上传png或jpg或gif格式的图片\");\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n    onOversize(file) {\r\n      this.$messagebox(\"上传提示\", \"文件不能超过500kb\");\r\n      return false;\r\n    },\r\n  },\r\n};\r\n</script>"]}]}