{"remainingRequest":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\桌面\\nectarine\\nectarine_isweb\\src\\views\\more\\xj.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\src\\views\\more\\xj.vue","mtime":1603419317819},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJjYW1lcmFzLWFuZC1hbGJ1bXMiLAogIGRhdGEoKXsKICAgIHJldHVybnsKICAgICAgaW1nTGlzdDogW10sCiAgICAgIGRhdGFzOiBuZXcgRm9ybURhdGEoKSwKICAgICAgZmlsZXM6MCwKICAgICAgc2l6ZTowCiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIC8v6LCD55So55u45YaMJuebuOacugogICAgZmlsZUNsaWNrKCkgewogICAgICAkKCcjdXBsb2FkX2ZpbGUnKS5jbGljaygpOwoKICAgIH0sCiAgICAvL+iwg+eUqOaJi+acuuaRhOWDj+WktOW5tuaLjeeFpwogICAgZ2V0SW1hZ2UoKSB7CiAgICAgIGxldCBjbXIgPSBwbHVzLmNhbWVyYS5nZXRDYW1lcmEoKTsKICAgICAgY21yLmNhcHR1cmVJbWFnZShmdW5jdGlvbihwKSB7CiAgICAgICAgcGx1cy5pby5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJMKHAsIGZ1bmN0aW9uKGVudHJ5KSB7CiAgICAgICAgICBjb21wcmVzc0ltYWdlKGVudHJ5LnRvTG9jYWxVUkwoKSxlbnRyeS5uYW1lKTsKICAgICAgICB9LCBmdW5jdGlvbihlKSB7CiAgICAgICAgICBwbHVzLm5hdGl2ZVVJLnRvYXN0KCLor7vlj5bmi43nhafmlofku7bplJnor6/vvJoiICsgZS5tZXNzYWdlKTsKICAgICAgICB9KTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICB9LCB7CiAgICAgICAgZmlsdGVyOiAnaW1hZ2UnCiAgICAgIH0pOwogICAgfSwKICAgIC8v5LuO55u45YaM6YCJ5oup54Wn54mHCiAgICBnYWxsZXJ5SW1ncygpIHsKICAgICAgcGx1cy5nYWxsZXJ5LnBpY2soZnVuY3Rpb24oZSkgewogICAgICAgIGxldCBuYW1lID0gZS5zdWJzdHIoZS5sYXN0SW5kZXhPZignLycpICsgMSk7CiAgICAgICAgY29tcHJlc3NJbWFnZShlLG5hbWUpOwogICAgICB9LCBmdW5jdGlvbihlKSB7CiAgICAgIH0sIHsKICAgICAgICBmaWx0ZXI6ICJpbWFnZSIKICAgICAgfSk7CiAgICB9LAogICAgLy/ngrnlh7vkuovku7bvvIzlvLnlh7rpgInmi6nmkYTlg4/lpLTlkoznm7jlhoznmoTpgInpobkKICAgIHNob3dBY3Rpb25TaGVldCgpIHsKICAgICAgbGV0IGJ0cyA9IFt7CiAgICAgICAgdGl0bGU6ICLmi43nhaciCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuS7juebuOWGjOmAieaLqSIKICAgICAgfV07CiAgICAgIHBsdXMubmF0aXZlVUkuYWN0aW9uU2hlZXQoewogICAgICAgICAgY2FuY2VsOiAi5Y+W5raIIiwKICAgICAgICAgIGJ1dHRvbnM6IGJ0cwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24oZSkgewogICAgICAgICAgaWYgKGUuaW5kZXggPT0gMSkgewogICAgICAgICAgICB0aGlzLmdldEltYWdlKCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGUuaW5kZXggPT0gMikgewogICAgICAgICAgICB0aGlzLmdhbGxlcnlJbWdzKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICApOwogICAgfSwKICAgIGZpbGVDaGFuZ2UoZWwpIHsKICAgICAgdGhpcy5maWxlcz0kKCIjdXBsb2FkX2ZpbGUiKS5nZXQoMCkuZmlsZXM7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmlsZXMubGVuZ3RoKTsKICAgICAgZm9yKGxldCBpPTA7aTx0aGlzLmZpbGVzLmxlbmd0aDtpKyspewogICAgICAgIHRoaXMuZGF0YXMuYXBwZW5kKCJmaWxlIix0aGlzLmZpbGVzW2ldKTsKICAgICAgfQogICAgICB0aGlzLnNob3cxPWZhbHNlOwogICAgICBjb25zb2xlLmxvZyh0eXBlb2YgdGhpcy5maWxlcyk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmlsZXMpOwogICAgICBpZiAoIWVsLnRhcmdldC5maWxlc1swXS5zaXplKSByZXR1cm47CiAgICAgIHRoaXMuZmlsZUxpc3QoZWwudGFyZ2V0KTsKICAgICAgZWwudGFyZ2V0LnZhbHVlID0gJycKICAgIH0sCiAgICBmaWxlTGlzdChmaWxlTGlzdCkgewogICAgICBsZXQgZmlsZXMgPSBmaWxlTGlzdC5maWxlczsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8v5Yik5pat5piv5ZCm5Li65paH5Lu25aS5CiAgICAgICAgaWYgKGZpbGVzW2ldLnR5cGUgIT0gJycpIHsKICAgICAgICAgIHRoaXMuZmlsZUFkZChmaWxlc1tpXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8v5paH5Lu25aS55aSE55CGCiAgICAgICAgICB0aGlzLmZvbGRlcnMoZmlsZUxpc3QuaXRlbXNbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8v5paH5Lu25aS55aSE55CGCiAgICBmb2xkZXJzKGZpbGVzKSB7CiAgICAgIGxldCBfdGhpcyA9IHRoaXM7CiAgICAgIC8v5Yik5pat5piv5ZCm5Li65Y6f55SfZmlsZQogICAgICBpZiAoZmlsZXMua2luZCkgewogICAgICAgIGZpbGVzID0gZmlsZXMud2Via2l0R2V0QXNFbnRyeSgpOwogICAgICB9CiAgICAgIGZpbGVzLmNyZWF0ZVJlYWRlcigpLnJlYWRFbnRyaWVzKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoZmlsZVtpXS5pc0ZpbGUpIHsKICAgICAgICAgICAgX3RoaXMuZm9sZGVyc0FkZChmaWxlW2ldKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLmZvbGRlcnMoZmlsZVtpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGZpbGVBZGQoZmlsZSkgewogICAgICAvL+aAu+Wkp+WwjwogICAgICB0aGlzLnNpemUgPSB0aGlzLnNpemUgKyBmaWxlLnNpemU7CiAgICAgIC8v5Yik5pat5piv5ZCm5Li65Zu+54mH5paH5Lu2CiAgICAgIGlmIChmaWxlLnR5cGUuaW5kZXhPZignaW1hZ2UnKSA9PSAtMSkgewogICAgICAgIGZpbGUuc3JjID0gJ3dlbmppYW4ucG5nJzsKICAgICAgICB0aGlzLmltZ0xpc3QucHVzaCh7CiAgICAgICAgICBmaWxlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgcmVhZGVyLnZ1ZSA9IHRoaXM7CiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZpbGUuc3JjID0gdGhpcy5yZXN1bHQ7CiAgICAgICAgICB0aGlzLnZ1ZS5pbWdMaXN0LnB1c2goewogICAgICAgICAgICBmaWxlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBmaWxlRGVsKGluZGV4KSB7CiAgICAgIHRoaXMuc2l6ZSA9IHRoaXMuc2l6ZSAtIHRoaXMuaW1nTGlzdFtpbmRleF0uZmlsZS5zaXplOy8v5oC75aSn5bCPCiAgICAgIHRoaXMuaW1nTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICAgIGJ5dGVzVG9TaXplKGJ5dGVzKSB7CiAgICAgIGlmIChieXRlcyA9PT0gMCl7CiAgICAgICAgcmV0dXJuICcwIEInOwogICAgICB9CiAgICAgIGxldCBrID0gMTAwMCwgLy8gb3IgMTAyNAogICAgICAgIHNpemVzID0gWydCJywgJ0tCJywgJ01CJywgJ0dCJywgJ1RCJywgJ1BCJywgJ0VCJywgJ1pCJywgJ1lCJ10sCiAgICAgICAgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpOwogICAgICByZXR1cm4gKGJ5dGVzIC8gTWF0aC5wb3coaywgaSkpLnRvUHJlY2lzaW9uKDMpICsgJyAnICsgc2l6ZXNbaV07CiAgICB9LAogICAgZHJhZ2VudGVyKGVsKSB7CiAgICAgIGVsLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBlbC5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSwKICAgIGRyYWdvdmVyKGVsKSB7CiAgICAgIGVsLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBlbC5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSwKICAgIGRyb3AoZWwpIHsKICAgICAgZWwuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIGVsLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHRoaXMuZmlsZUxpc3QoZWwuZGF0YVRyYW5zZmVyKTsKICAgIH0sCiAgICBzaG93cyhldCx0eCl7CiAgICAgIHRoaXMuc3RydXQ9ZXQ7CiAgICAgIHRoaXMudHh0PXR4OwogICAgfSwKICAgIGhhbmRsZUNsaWNrKCl7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnYWRkJykKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["xj.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"xj.vue","sourceRoot":"src/views/more","sourcesContent":["<template>\r\n  <div>\r\n    <input id=\"upload_file\" type=\"file\" style=\"display: none;\" accept='image/*' name=\"file\"  @change=\"fileChange($event)\"/>\r\n    <div class=\"image-item space\" @click=\"showActionSheet()\">\r\n      <div class=\"image-up\"></div>\r\n    </div>\r\n   \r\n    <div class=\"upload_warp\">\r\n      <div class=\"upload_warp_img\">\r\n        <div class=\"upload_warp_img_div\" v-for=\"(item,index) in imgList\" :key=\"index\">\r\n          <div class=\"upload_warp_img_div_top\">\r\n            <!-- <img src=\"http://114.115.162.39/static/image/x.png\" class=\"upload_warp_img_div_del\" @click=\"fileDel(index)\"> -->\r\n          </div>\r\n          <img :src=\"item.file.src\" style=\"display: inline-block;\">\r\n        </div>\r\n        <div class=\"upload_warp_left\" id=\"upload_warp_left\" @click=\"fileClick()\" v-if=\"this.imgList.length < 6\">\r\n          <!--<img src=\"../assets/upload.png\">-->\r\n          <!-- <img src=\"../assets/images/添加图片.png\" class=\"imgs\"/> -->\r\n        </div>\r\n      </div>\r\n \r\n    </div>\r\n   \r\n    <div class=\"upload_warp_text\">\r\n    <span>选中{{imgList.length}}张文件，共{{bytesToSize(this.size)}}</span>\r\n    </div>\r\n  </div>\r\n \r\n</template>\r\n<script type=\"text/ecmascript-6\">\r\n    export default {\r\n        name: \"cameras-and-albums\",\r\n      data(){\r\n        return{\r\n          imgList: [],\r\n          datas: new FormData(),\r\n          files:0,\r\n          size:0\r\n        }\r\n      },\r\n      methods:{\r\n        //调用相册&相机\r\n        fileClick() {\r\n          $('#upload_file').click();\r\n \r\n        },\r\n        //调用手机摄像头并拍照\r\n        getImage() {\r\n          let cmr = plus.camera.getCamera();\r\n          cmr.captureImage(function(p) {\r\n            plus.io.resolveLocalFileSystemURL(p, function(entry) {\r\n              compressImage(entry.toLocalURL(),entry.name);\r\n            }, function(e) {\r\n              plus.nativeUI.toast(\"读取拍照文件错误：\" + e.message);\r\n            });\r\n          }, function(e) {\r\n          }, {\r\n            filter: 'image'\r\n          });\r\n        },\r\n        //从相册选择照片\r\n        galleryImgs() {\r\n          plus.gallery.pick(function(e) {\r\n            let name = e.substr(e.lastIndexOf('/') + 1);\r\n            compressImage(e,name);\r\n          }, function(e) {\r\n          }, {\r\n            filter: \"image\"\r\n          });\r\n        },\r\n        //点击事件，弹出选择摄像头和相册的选项\r\n        showActionSheet() {\r\n          let bts = [{\r\n            title: \"拍照\"\r\n          }, {\r\n            title: \"从相册选择\"\r\n          }];\r\n          plus.nativeUI.actionSheet({\r\n              cancel: \"取消\",\r\n              buttons: bts\r\n            },\r\n            function(e) {\r\n              if (e.index == 1) {\r\n                this.getImage();\r\n              } else if (e.index == 2) {\r\n                this.galleryImgs();\r\n              }\r\n            }\r\n          );\r\n        },\r\n        fileChange(el) {\r\n          this.files=$(\"#upload_file\").get(0).files;\r\n          console.log(this.files.length);\r\n          for(let i=0;i<this.files.length;i++){\r\n            this.datas.append(\"file\",this.files[i]);\r\n          }\r\n          this.show1=false;\r\n          console.log(typeof this.files);\r\n          console.log(this.files);\r\n          if (!el.target.files[0].size) return;\r\n          this.fileList(el.target);\r\n          el.target.value = ''\r\n        },\r\n        fileList(fileList) {\r\n          let files = fileList.files;\r\n          for (let i = 0; i < files.length; i++) {\r\n            //判断是否为文件夹\r\n            if (files[i].type != '') {\r\n              this.fileAdd(files[i]);\r\n            } else {\r\n              //文件夹处理\r\n              this.folders(fileList.items[i]);\r\n            }\r\n          }\r\n        },\r\n        //文件夹处理\r\n        folders(files) {\r\n          let _this = this;\r\n          //判断是否为原生file\r\n          if (files.kind) {\r\n            files = files.webkitGetAsEntry();\r\n          }\r\n          files.createReader().readEntries(function (file) {\r\n            for (let i = 0; i < file.length; i++) {\r\n              if (file[i].isFile) {\r\n                _this.foldersAdd(file[i]);\r\n              } else {\r\n                _this.folders(file[i]);\r\n              }\r\n            }\r\n          })\r\n        },\r\n        fileAdd(file) {\r\n          //总大小\r\n          this.size = this.size + file.size;\r\n          //判断是否为图片文件\r\n          if (file.type.indexOf('image') == -1) {\r\n            file.src = 'wenjian.png';\r\n            this.imgList.push({\r\n              file\r\n            });\r\n          } else {\r\n            let reader = new FileReader();\r\n            reader.vue = this;\r\n            reader.readAsDataURL(file);\r\n            reader.onload = function () {\r\n              file.src = this.result;\r\n              this.vue.imgList.push({\r\n                file\r\n              });\r\n            }\r\n          }\r\n        },\r\n        fileDel(index) {\r\n          this.size = this.size - this.imgList[index].file.size;//总大小\r\n          this.imgList.splice(index, 1);\r\n        },\r\n        bytesToSize(bytes) {\r\n          if (bytes === 0){\r\n            return '0 B';\r\n          }\r\n          let k = 1000, // or 1024\r\n            sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],\r\n            i = Math.floor(Math.log(bytes) / Math.log(k));\r\n          return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];\r\n        },\r\n        dragenter(el) {\r\n          el.stopPropagation();\r\n          el.preventDefault();\r\n        },\r\n        dragover(el) {\r\n          el.stopPropagation();\r\n          el.preventDefault();\r\n        },\r\n        drop(el) {\r\n          el.stopPropagation();\r\n          el.preventDefault();\r\n          this.fileList(el.dataTransfer);\r\n        },\r\n        shows(et,tx){\r\n          this.strut=et;\r\n          this.txt=tx;\r\n        },\r\n        handleClick(){\r\n          this.$store.commit('add')\r\n        },\r\n      },\r\n    }\r\n</script>"]}]}