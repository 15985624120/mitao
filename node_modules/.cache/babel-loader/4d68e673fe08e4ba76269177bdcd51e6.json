{"remainingRequest":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\babel-loader\\lib\\index.js!E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\src\\components\\imgs.vue","mtime":1603989544648},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\桌面\\nectarine\\nectarine_isweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkU6L1x1Njg0Q1x1OTc2Mi9uZWN0YXJpbmUvbmVjdGFyaW5lX2lzd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0ZXh0OiAiIiwKICAgICAgZmlsZUxpc3Q6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaW1nc2M6IGZ1bmN0aW9uIGltZ3NjKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uc29sZS5sb2coIjEiKTsKCiAgICAgIGlmICh0aGlzLmZpbGVMaXN0Lmxlbmd0aCA9PSAwIHx8IHRoaXMudGV4dC5sZW5ndGggPT0gMCkgewogICAgICAgIGNvbnNvbGUubG9nKCIyIik7CiAgICAgICAgdGhpcy4kdG9hc3QoewogICAgICAgICAgbWVzc2FnZTogIuayoeacieWGheWuueWPr+WPkeW4gyIsCiAgICAgICAgICBwb3NpdGlvbjogInRvcCIsCiAgICAgICAgICBkdXJhdGlvbjogIjEwMDAiCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHVzZW5hbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidW5hbWUiKTsKICAgICAgICB2YXIgYXJyID0gW107CiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZpbGVMaXN0KSwKICAgICAgICAgICAgX3N0ZXA7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgdmFsID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZmlsZXMiLCB2YWwuZmlsZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuYWZ0ZXJSZWFkKCkpIHsKICAgICAgICAgIHRoaXMuJGluZGljYXRvci5vcGVuKHsKICAgICAgICAgICAgdGV4dDogIuWKoOi9veS4rS4uLiIsCiAgICAgICAgICAgIHNwaW5uZXJUeXBlOiAidHJpcGxlLWJvdW5jZSIKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5heGlvcy5wb3N0KCIvdXNlcnMvdXBsb2FkIiwgZm9ybURhdGEsIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIGVuY3R5cGU6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIgogICAgICAgICAgICB9CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgdmFyIHNyYyA9IHJlcy5kYXRhLmFycjsKCiAgICAgICAgICAgIF90aGlzLmF4aW9zLnBvc3QoIi91c2Vycy90ZXN0IiwgImFycj0iLmNvbmNhdChzcmMsICImdGV4dD0iKS5jb25jYXQoX3RoaXMudGV4dCwgIiZ1c2VuYW1lPSIpLmNvbmNhdCh1c2VuYW1lKSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnNheCA9PSAxKSB7CiAgICAgICAgICAgICAgICBfdGhpcy4kaW5kaWNhdG9yLmNsb3NlKCk7CgogICAgICAgICAgICAgICAgX3RoaXMuJHRvYXN0KHsKICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuWPkeihqOaIkOWKnyIsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wIiwKICAgICAgICAgICAgICAgICAgZHVyYXRpb246ICIxMDAwIgogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLiRyb3V0ZXIucHVzaCgiL2Rvbmd0YWkiKTsKICAgICAgICAgICAgICAgIH0sIDIwMDApOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBfdGhpcy4kdG9hc3QoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5Y+R6KGo5aSx6LSlIiwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AiLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogIjEwMDAiCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfdGhpcy4kcm91dGVyLnB1c2goIi9kb25ndGFpIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFmdGVyUmVhZDogZnVuY3Rpb24gYWZ0ZXJSZWFkKGZpbGUpIHsKICAgICAgLy8gY29uc29sZS5sb2coZmlsZSk7CiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5maWxlTGlzdCksCiAgICAgICAgICBfc3RlcDI7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgdmFsID0gX3N0ZXAyLnZhbHVlOwoKICAgICAgICAgIGlmICh2YWwuZmlsZS50eXBlICE9PSAiaW1hZ2UvanBlZyIgJiYgdmFsLmZpbGUudHlwZSAhPT0gImltYWdlL3BuZyIgJiYgdmFsLmZpbGUudHlwZSAhPT0gImltYWdlL2dpZiIpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZWJveCgi5LiK5Lyg5o+Q56S6IiwgIuWPquiDveS4iuS8oHBuZ+aIlmpwZ+aIlmdpZuagvOW8j+eahOWbvueJhyIpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgb25PdmVyc2l6ZTogZnVuY3Rpb24gb25PdmVyc2l6ZShmaWxlKSB7CiAgICAgIHRoaXMuJG1lc3NhZ2Vib3goIuS4iuS8oOaPkOekuiIsICLmlofku7bkuI3og73otoXov4c1MDBrYiIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["imgs.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA;AAFA,KAAA;AAIA,GANA;AAOA,EAAA,OAAA,EAAA;AACA,IAAA,KADA,mBACA;AAAA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,UAAA,KAAA,QAAA,CAAA,MAAA,IAAA,CAAA,IAAA,KAAA,IAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,aAAA,MAAA,CAAA;AACA,UAAA,OAAA,EAAA,SADA;AAEA,UAAA,QAAA,EAAA,KAFA;AAGA,UAAA,QAAA,EAAA;AAHA,SAAA;AAKA,OAPA,MAOA;AACA,YAAA,OAAA,GAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,YAAA,GAAA,GAAA,EAAA;AACA,YAAA,QAAA,GAAA,IAAA,QAAA,EAAA;;AAHA,mDAIA,KAAA,QAJA;AAAA;;AAAA;AAIA,8DAAA;AAAA,gBAAA,GAAA;AACA,YAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,GAAA,CAAA,IAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;;AAOA,YAAA,KAAA,SAAA,EAAA,EAAA;AACA,eAAA,UAAA,CAAA,IAAA,CAAA;AACA,YAAA,IAAA,EAAA,QADA;AAEA,YAAA,WAAA,EAAA;AAFA,WAAA;AAIA,eAAA,KAAA,CACA,IADA,CACA,eADA,EACA,QADA,EACA;AACA,YAAA,OAAA,EAAA;AACA,cAAA,OAAA,EAAA;AADA;AADA,WADA,EAMA,IANA,CAMA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,GAAA,GAAA,CAAA,IAAA,CAAA,GAAA;;AACA,YAAA,KAAA,CAAA,KAAA,CACA,IADA,CAEA,aAFA,gBAGA,GAHA,mBAGA,KAAA,CAAA,IAHA,sBAGA,OAHA,GAKA,IALA,CAKA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,IAAA,CAAA,GAAA,IAAA,CAAA,EAAA;AACA,gBAAA,KAAA,CAAA,UAAA,CAAA,KAAA;;AACA,gBAAA,KAAA,CAAA,MAAA,CAAA;AACA,kBAAA,OAAA,EAAA,MADA;AAEA,kBAAA,QAAA,EAAA,KAFA;AAGA,kBAAA,QAAA,EAAA;AAHA,iBAAA;;AAKA,gBAAA,UAAA,CAAA,YAAA;AACA,kBAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,UAAA;AACA,iBAFA,EAEA,IAFA,CAAA;AAGA,eAVA,MAUA;AACA,gBAAA,KAAA,CAAA,MAAA,CAAA;AACA,kBAAA,OAAA,EAAA,MADA;AAEA,kBAAA,QAAA,EAAA,KAFA;AAGA,kBAAA,QAAA,EAAA;AAHA,iBAAA;;AAKA,gBAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,UAAA;AACA;AACA,aAxBA;AAyBA,WAjCA;AAkCA;AACA;AACA,KA1DA;AA2DA,IAAA,SA3DA,qBA2DA,IA3DA,EA2DA;AACA;AADA,kDAEA,KAAA,QAFA;AAAA;;AAAA;AAEA,+DAAA;AAAA,cAAA,GAAA;;AACA,cACA,GAAA,CAAA,IAAA,CAAA,IAAA,KAAA,YAAA,IACA,GAAA,CAAA,IAAA,CAAA,IAAA,KAAA,WADA,IAEA,GAAA,CAAA,IAAA,CAAA,IAAA,KAAA,WAHA,EAIA;AACA,iBAAA,WAAA,CAAA,MAAA,EAAA,sBAAA;AACA,mBAAA,KAAA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;;AAYA,aAAA,IAAA;AACA,KAxEA;AAyEA,IAAA,UAzEA,sBAyEA,IAzEA,EAyEA;AACA,WAAA,WAAA,CAAA,MAAA,EAAA,aAAA;AACA,aAAA,KAAA;AACA;AA5EA;AAPA,CAAA","sourcesContent":["<template>\r\n  <div class=\"imgs fens\">\r\n    <mt-header title=\"动态\">\r\n      <router-link to=\"/dongtai\" slot=\"left\">\r\n        <mt-button type=\"default\" icon=\"back\" size=\"normal\"></mt-button>\r\n      </router-link>\r\n    </mt-header>\r\n    <div>\r\n      <textarea\r\n        v-model=\"text\"\r\n        placeholder=\"说说您此刻的想法\"\r\n        class=\"textar\"\r\n      ></textarea>\r\n    </div>\r\n    <div class=\"dongtai\">\r\n      <van-uploader\r\n        v-model=\"fileList\"\r\n        multiple\r\n        :after-read=\"afterRead\"\r\n        :max-count=\"9\"\r\n        :max-size=\"500 * 1024\"\r\n        @oversize=\"onOversize\"\r\n      />\r\n      <br />\r\n      <mt-button @click=\"imgsc\" type=\"primary\" size=\"large\">发布</mt-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style  >\r\n/* 导航粉色 */\r\n.imgs.fens .mint-header {\r\n  background: #ff6699;\r\n}\r\n/* 棕色 */\r\n.imgs.zong .mint-header {\r\n  background: #9b7159;\r\n}\r\n.imgs .textar {\r\n  width: 100%;\r\n  margin: 0;\r\n  box-sizing: border-box;\r\n  padding: 20px;\r\n  border: none;\r\n  resize: none;\r\n}\r\n.imgs .dongtai {\r\n  padding: 20px;\r\n}\r\n.imgs.fens .mint-button--primary {\r\n  background: #ffccdd;\r\n}\r\n/* 按钮粉色系 */\r\n.imgs.zong .mint-button--primary {\r\n  background: #9b7159;\r\n}\r\n</style>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      text: \"\",\r\n      fileList: [],\r\n    };\r\n  },\r\n  methods: {\r\n    imgsc() {\r\n      console.log(\"1\");\r\n      if (this.fileList.length == 0 || this.text.length == 0) {\r\n        console.log(\"2\");\r\n        this.$toast({\r\n          message: \"没有内容可发布\",\r\n          position: \"top\",\r\n          duration: \"1000\",\r\n        });\r\n      } else {\r\n        let usename = localStorage.getItem(\"uname\");\r\n        let arr = [];\r\n        let formData = new FormData();\r\n        for (let val of this.fileList) {\r\n          formData.append(\"files\", val.file);\r\n        }\r\n        if (this.afterRead()) {\r\n          this.$indicator.open({\r\n            text: \"加载中...\",\r\n            spinnerType: \"triple-bounce\",\r\n          });\r\n          this.axios\r\n            .post(\"/users/upload\", formData, {\r\n              headers: {\r\n                enctype: \"multipart/form-data\",\r\n              },\r\n            })\r\n            .then((res) => {\r\n              let src = res.data.arr;\r\n              this.axios\r\n                .post(\r\n                  \"/users/test\",\r\n                  `arr=${src}&text=${this.text}&usename=${usename}`\r\n                )\r\n                .then((res) => {\r\n                  if (res.data.sax == 1) {\r\n                    this.$indicator.close();\r\n                    this.$toast({\r\n                      message: \"发表成功\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    setTimeout(() => {\r\n                      this.$router.push(\"/dongtai\");\r\n                    }, 2000);\r\n                  } else {\r\n                    this.$toast({\r\n                      message: \"发表失败\",\r\n                      position: \"top\",\r\n                      duration: \"1000\",\r\n                    });\r\n                    this.$router.push(\"/dongtai\");\r\n                  }\r\n                });\r\n            });\r\n        }\r\n      }\r\n    },\r\n    afterRead(file) {\r\n      // console.log(file);\r\n      for (var val of this.fileList) {\r\n        if (\r\n          val.file.type !== \"image/jpeg\" &&\r\n          val.file.type !== \"image/png\" &&\r\n          val.file.type !== \"image/gif\"\r\n        ) {\r\n          this.$messagebox(\"上传提示\", \"只能上传png或jpg或gif格式的图片\");\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n    onOversize(file) {\r\n      this.$messagebox(\"上传提示\", \"文件不能超过500kb\");\r\n      return false;\r\n    },\r\n  },\r\n};\r\n</script>"],"sourceRoot":"src/components"}]}